
#include <stdio.h>
#include <assert.h>
#include <string.h>
#include "sha256.h"
//#include "tap.c/tap.h"

// "hello"
unsigned char hello_hashed[] = {
  0x2c, 0xf2, 0x4d, 0xba, 0x5f, 0xb0, 0xa3, 0x0e, 0x26, 0xe8, 0x3b, 0x2a,
  0xc5, 0xb9, 0xe2, 0x9e, 0x1b, 0x16, 0x1e, 0x5c, 0x1f, 0xa7, 0x42, 0x5e,
  0x73, 0x04, 0x33, 0x62, 0x93, 0x8b, 0x98, 0x24
};

// ""
unsigned char empty_hashed[] = {
  0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14, 0x9a, 0xfb, 0xf4, 0xc8,
  0x99, 0x6f, 0xb9, 0x24, 0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c,
  0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55
};




char message[] =
        "Be that word our sign of parting, bird or fiend! I shrieked upstarting"
        "Get thee back into the tempest and the Nights Plutonian shore!"
        "Leave no black plume as a token of that lie thy soul hath spoken!"
        "Leave my loneliness unbroken! quit the bust above my door!"
        "Take thy beak from out my heart, and take thy form from off my door!"
        "Quoth the raven, Nevermore.  ";

    /* Expected SHA-256 for the message. */
uint8_t sha256[] = {0x63, 0x76, 0xea, 0xcc, 0xc9, 0xa2, 0xc0, 0x43, 0xf4, 0xfb, 0x01,
                    0x34, 0x69, 0xb3, 0x0c, 0xf5, 0x28, 0x63, 0x5c, 0xfa, 0xa5, 0x65,
                    0x60, 0xef, 0x59, 0x7b, 0xd9, 0x1c, 0xac, 0xaa, 0x31, 0xf7};

uint8_t pubkey[] = 
{

#if 0
	 0x04,0xfb,0xe8,0xb8,0x25,0xa4,0x2c,0x3c,0xa9,0x81,0xb9,0x43,0xc7,0x73,0xf1,
	 0x5b,0x0d,0x68,0x29,0xe2,0x47,0xb2,0x91,0x00,0xf3,0x66,0xfb,0xff,0xeb,0x27,
	 0xf3,0x6d,0x43,0x7a,0x33,0x06,0xc2,0x9a,0xd4,0x74,0x0c,0x32,0x9c,0x02,0x76,
	 0x7e,0x39,0x7b,0xb9,0x5b,0xd8,0xf1,0xb7,0x62,0x76,0x13,0x1d,0x0c,0x09,0x31,
	 0x72,0x71,0x91,0x40,0x68
#endif


#if 0
	 0xfb,0xe8,0xb8,0x25,0xa4,0x2c,0x3c,0xa9,0x81,0xb9,0x43,0xc7,0x73,0xf1,
	 0x5b,0x0d,0x68,0x29,0xe2,0x47,0xb2,0x91,0x00,0xf3,0x66,0xfb,0xff,0xeb,0x27,
	 0xf3,0x6d,0x43,0x7a,0x33,0x06,0xc2,0x9a,0xd4,0x74,0x0c,0x32,0x9c,0x02,0x76,
	 0x7e,0x39,0x7b,0xb9,0x5b,0xd8,0xf1,0xb7,0x62,0x76,0x13,0x1d,0x0c,0x09,0x31,
	 0x72,0x71,0x91,0x40,0x68
#endif


#if 1


	 0x96,0x14,0xee,0x53,0x90,0xdb,0x1c,0xfb,0xbd,0xcd,0x09,0x10,0xa2,0x19,
	 0x27,0xa9,0xa7,0x88,0x8a,0xd4,0xbe,0xd5,0x26,0x39,0xe9,0xe4,0xa3,0xe8,0x7f,
	 0x8e,0xe0,0xe9,0x6c,0x64,0x53,0xdf,0xef,0xa4,0xfb,0xb7,0xf2,0xde,0xbc,0xfd,
	 0x50,0xe0,0xc9,0xf4,0x1c,0xce,0xb3,0x1c,0x4b,0xc2,0x73,0xc3,0x44,0x16,0x91,
	 0x7b,0xfb,0x8c,0xca,0x33


#endif



#if 0
		 0x0b,0xb9,0x0b,0x53,0x1d,0xf7,0xcb,0x14,0xd2,0x5d,0xd5,0x83,0x34,0x7b,
		 0x7f,0x31,0x8f,0xfd,0x9f,0x3e,0x01,0xa5,0xa3,0x23,0xaa,0xd7,0xd5,0x75,0xda,
		 0xda,0xcd,0x43,0x5e,0x81,0x96,0x8a,0x2c,0xc7,0xef,0xa0,0x14,0xc4,0xb6,0x36,
		 0x6a,0x01,0xc5,0x4d,0x6e,0xe5,0xb9,0xca,0x86,0xc0,0x93,0xa9,0x55,0x44,0x28,
		 0x64,0xd9,0xa5,0xa0,0x9a


#endif

};

int main (void) {
 // plan(2);

  unsigned char buf[1024*8] = {0};

  //sha256_hash(buf, (unsigned char*)"hello", 5);
#if 0
void sha256_hash(unsigned char *buf, const unsigned char *data, size_t size)
{
  sha256_t hash;
  sha256_init(&hash);
  sha256_update(&hash, data, size);
  sha256_final(&hash, buf);
}
#endif

  sha256_t hash;
  sha256_init(&hash);
 // sha256_update(&hash, (unsigned char*)message, strlen(message));
  sha256_update(&hash, (unsigned char*)pubkey, 64);
  sha256_final(&hash, buf);

//sha256_hash(buf, (unsigned char*)message, strlen(message));

  for(int i=0;i<32;i++)
{
	printf("%02x ",buf[i]);
	if(i)
	{
		if((i+1)%16 == 0)
			printf("\n");
	}

}

printf("\n");
return 0;
#if 0
note("basic stuff");
ok(memcmp(buf, hello_hashed, 32) == 0, "should hash correctly");

sha256_t hash;
sha256_init(&hash);
sha256_update(&hash, (unsigned char*)"", 0);
sha256_update(&hash, (unsigned char*)"", 0);
sha256_final(&hash, buf);

ok(memcmp(buf, empty_hashed, 32) == 0, "empty should hash correctly");

done_testing();
#endif
}
